<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">

<head>
	<meta charset="utf-8" />
	<title></title>
	<script src="js/jquery-3.2.1.js"></script>
	<script src="js/common/moment.js"></script>

	<link href="css/bootstrap.css" rel="stylesheet" />
	<!-- <link href="css/bootstrap-theme.css" rel="stylesheet" /> -->
	<link href="js/bootstrap-table.css" rel="stylesheet" />
	<script src="js/bootstrap.js"></script>

	<!--加入bootstrap的js文件-->
	<script src="js/bootstrap-table.js"></script>

	<link href="js/editable/css/bootstrap-editable.css" rel="stylesheet" />
	<script src="js/editable/js/bootstrap-editable.js"></script>
	<script src="js/common/dateFormart.js"></script>
	<!-- <script src="js/editable/js/bootstrap-table-editable.js"></script> -->
	<style>
	html body{
		background:linear-gradient(45deg,rgb(74, 74, 156) 50%,rgb(46, 37, 158) 50%); 
		height: 100%;
	}
	#tb_user{
		/* background: rgb(82, 82, 177); */
	}
	#table_parent{
		/* background: rgb(201, 201, 212); */
	}
	</style>
	<script type="application/javascript">
		$(function () {
			// $.fn.editable.defaults.mode = 'inline';
			var curRow = {};

			$(function () {
				//加载table
				$("#tb_user").bootstrapTable({
					toolbar: "#toolbar",
					idField: "Id",
					pagination: true,
					showRefresh: true,
					search: true,
					// striped: true,
					clickToSelect: true,
					queryParams: function (param) {
						return {};
					},
					url: "data1.json",
					columns: [{
						checkbox: true
					}, {
						field: "UserName",
						title: "用户名",
						formatter: function (value, row, index) {
							var result = "<a href=\"#\" class=\"my_text\" name=\"UserName\" data-type=\"text\" data-pk=\"" + row.Id + "\"mode=\"inline\" data-title=\"用户名\">" + value + "</a>";
							return result;
						}


					},
					{
						field: "DeptId",
						title: "部门",
						// editable: {
						// 	type: 'select',
						// 	title: '部门',
						// 	source: [{ value: "1", text: "研发部" }, { value: "2", text: "销售部" }, { value: "3", text: "行政部" }]
						// },
						formatter: function (value, row, index) {
							var reuslt = "<a href=\"#\" class=\"my_select\">" + value + "</a>";
							// console.log(reuslt);
							// var obj=value;
							return reuslt;
						}
					}, {
						field: "DutyDate",
						title: "值班日期",
						formatter: function (value, row, index) {

							//使用monment.js完成时间的格式化
							var date = moment(value, "YYYY/MM/DD");
							var date_str = date.format("YYYY-MM-DD");

							var result = "<a href=\"#\" class=\"my_dutydate\" id=\"dob\" data-type=\"combodate\" data-value=\"" + date_str + "\" data-format=\"YYYY-MM-DD\" data-viewformat=\"YYYY-MM-DD\" data-template=\"YYYY /MMM / D \" data-pk=\"1\"  data-title=\"请选择值班日期\">" + date_str + "</a>";
							// var result="<a href=\"#\"  >"+value+"</a>";
							// result="123123";

							console.log(result);
							return result;
							// return date.format("yyyy-MM-dd");
						},
						// editable: {
						// 	type: 'date',
						// 	title: '日期'
						// }
					}],
					onClickRow: function (row, $element) {
						curRow = row;
					},
					//加载成功后执行
					onLoadSuccess: function (aa, bb, cc) {
						$(".my_text").editable({
							url: function (params) {
								var sName = $(this).attr("name");
								curRow[sName] = params.value;
								$.ajax({
									type: 'POST',
									url: "/Editable/Edit",
									data: curRow,
									dataType: 'JSON',
									success: function (data, textStatus, jqXHR) {
										alert('保存成功！');
									},
									error: function () { alert("error"); }
								});
							},
							type: 'text',
							mode: "inline",
						});

						$('.my_select').editable({
							type: "select",              //编辑框的类型。支持text|textarea|select|date|checklist等
							source: [{ value: 1, text: "主班" }, { value: 2, text: "副班" }, { value: 3, text: "行政班" }],
							title: "选择部门",           //编辑框的标题
							disabled: false,           //是否禁用编辑
							emptytext: "空文本",       //空值的默认文本
							mode: "inline",            //编辑框的模式：支持popup和inline两种模式，默认是popup            
						});
						$('.my_dutydate').editable({
							type: "date",              //编辑框的类型。支持text|textarea|select|date|checklist等

							disabled: false,           //是否禁用编辑
							emptytext: "空文本",       //空值的默认文本
							mode: "inline",            //编辑框的模式：支持popup和inline两种模式，默认是popup            
						});
					},
				});




			});


		});
	</script>
</head>

<body>
	<div class="container">
		<div class="panel-body" style="padding-bottom:0px;">
			<div class="panel panel-primary">
				<div class="panel-heading">查询条件</div>
				<div class="panel-body">
					<form id="formSearch" class="form-horizontal">
						<div class="form-group" style="margin-top:15px">
							<label class="control-label col-sm-1" for="txt_search_departmentname">姓名</label>
							<div class="col-sm-2">
								<input type="text" class="form-control" id="txt_search_departmentname">
							</div>
							<label class="control-label col-sm-1" for="txt_search_departmentname">组名</label>
							<div class="col-sm-2">
								<input type="text" class="form-control" id="txt_search_departmentname">
							</div>
							<label class="control-label col-sm-1" for="txt_search_statu">日期</label>
							<div class="col-sm-2">
								<input type="text" class="form-control" id="txt_search_statu">
							</div>
							<div class="col-sm-4 col-md-2" style="text-align:left;">
								<button type="button" style="margin-left:50px" id="btn_query" class="btn btn-primary">查询</button>
							</div>
						</div>
					</form>
				</div>
			</div>


		</div>
		<div class="panel-body">
			<div class="panel panel-primary">
				<div class="panel-heading">排班详情</div>
				<div class="panel-body">
					<div id="toolbar" class="btn-group">
						<button id="btn_add" type="button" class="btn btn-success">
							<span class="glyphicon glyphicon-plus" aria-hidden="true"></span>新增
						</button>
						<!-- <button id="btn_edit" type="button" class="btn btn-default">
							<span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>修改
						</button> -->
						<button id="btn_delete" type="button" class="btn btn-danger">
							<span class="glyphicon glyphicon-remove" aria-hidden="true"></span>删除
						</button>
					</div>
					<div id="table_parent">
						<table id="tb_user"></table>
					</div>
				</div>
			</div>
		</div>
		
		
		<!-- <div class="container">
			
	
	</div> -->
		<!-- /container -->
</body>

</html>